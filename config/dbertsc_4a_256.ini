# NB: section names are case sensitive, but option names are NOT!

# roaches - top to bottom
# roach020650 - 4
# roach02070f - 4
# roach020828 - 4
# roach020815 - 4
# roach020818 - 4 - drops packets
# roach02064a - 4
# roach02081a - 4
# roach020712 - 4
# roach02080f - 2
# roach020813 - 2
# roach020637 - 2
# roach02081e - 2
# roach02064b - 2
# roach02081c - 2
# roach02070e - 2
# roach02082d - 2

[FxCorrelator]
katcp_port = 7147
sample_rate_hz = 1712000000
timestamp_bits = 48
# Version of IGMP protocol to force on the engines
igmp_version = 2
# How long should we wait for ARP resolution?
arp_wait_time = 20
# at what interval do we poll sensors?
sensor_poll_time = 10
# how much time difference between the received f-engine times is allowed?
time_jitter_allowed_ms = 500
# how close should the received f-engine times be to the actual time
time_offset_allowed_s = 5
# how long should we wait to allow the switches to configure
switch_delay = 5

[bengine]

[beam0]
output_products = beam_0x
stream_index = 0
center_freq = 1284000000
bandwidth = 856000000
meta_ip = 127.0.0.1
meta_port = 8889
data_ip = 10.100.201.1
data_port = 8889
#source_weights = ant0_x:0.125,ant1_x:0.125,ant2_x:0.125,ant3_x:0.125
#source_weights = ant0_x:1.0,ant1_x:1.0,ant2_x:1.0,ant3_x:1.0
source_weights = ant0_x:0.25,ant1_x:0.25,ant2_x:0.25,ant3_x:0.25
source_poly = 2

[beam1]
output_products = beam_0y
stream_index = 1
center_freq = 1284000000
bandwidth = 856000000
meta_ip = 127.0.0.1
meta_port = 8890
data_ip = 10.100.201.1
data_port = 8890
#source_weights = ant0_y:0.250,ant1_y:0.250,ant2_y:0.250,ant3_y:0.250
source_weights = ant0_y:0,ant1_y:0,ant2_y:0,ant3_y:0
source_poly = 3

[fengine]
hosts = roach020650,roach02070f,roach020828,roach020815
bitstream = /srv/mkat_fpga/bitstreams/feng_wide/r2_c856m4k.fpg

# this has the opposite ordered d-engine data
# bitstream = /home/paulp/tmp/r2_c856m4k_2016_Apr_01_1115.fpg

# names and IPs of the sources to the f-engines
n_antennas = 4
# Number of f-engines per host - the PFB does two-pols, so only one, but it is two f-engines/pols
f_per_fpga = 2
# names to give the source polarisations - these must map to the IPs
source_names = ant0_x,ant0_y,ant1_x,ant1_y,ant2_x,ant2_y,ant3_x,ant3_y
# henno's lab dengine
source_mcast_ips = 239.2.0.64+1:8888,239.2.0.66+1:8888,239.2.0.64+1:8888,239.2.0.66+1:8888,239.2.0.64+1:8888,239.2.0.66+1:8888,239.2.0.64+1:8888,239.2.0.66+1:8888
# my fake digitiser
#source_mcast_ips = 239.2.0.10+1:8888,239.2.0.12+1:8888,239.2.0.10+1:8888,239.2.0.12+1:8888,239.2.0.10+1:8888,239.2.0.12+1:8888,239.2.0.10+1:8888,239.2.0.12+1:8888
# the filter boards
#source_mcast_ips = 239.2.0.20+1:8888,239.2.0.22+1:8888,239.2.0.20+1:8888,239.2.0.22+1:8888,239.2.0.20+1:8888,239.2.0.22+1:8888,239.2.0.20+1:8888,239.2.0.22+1:8888
# where should the f-data go?
destination_mcast_ips = 239.2.0.150+15:8888
# number of 10gbe ports per f-engine
ports_per_fengine = 2
# how many bits per ADC sample
sample_bits = 10
# how many parallel ADC samples do we get per digitiser clock?
adc_demux_factor = 8
# The processed analogue bandwidth
bandwidth = 856000000
# the centre frequency on the sky
true_cf = 1284000000
# Number of channels produced by the f-engine
n_chans = 4096
# FFT shifting schedule in decimal. A binary '1' shifts, a zero does not.
fft_shift = 2032
fft_shift = 4095
# The fixed-point format post FFT in the F engines
quant_format = 8.7
# Packet length of 10Gbe exchange data in 64 bit words.
10gbe_pkt_len = 128
# MAC, IP and port for 10Gbe cores
10gbe_start_ip = 10.100.0.150
10gbe_port = 8888
# SPEAD flavour, string in the form XX,YY. Default: 64,48. See the SPEAD documentation for details.
spead_flavour = 64,48
# Equalisation settings - one per input - must have the same suffix as the source names above
#eq_poly_ant0_x = 300
#eq_poly_ant0_y = 300
#eq_poly_ant1_x = 300
#eq_poly_ant1_y = 300
#eq_poly_ant2_x = 300
#eq_poly_ant2_y = 300
#eq_poly_ant3_x = 300
#eq_poly_ant3_y = 300
eq_poly_ant0_x = 0
eq_poly_ant0_y = 0
eq_poly_ant1_x = 0
eq_poly_ant1_y = 0
eq_poly_ant2_x = 0
eq_poly_ant2_y = 0
eq_poly_ant3_x = 0
eq_poly_ant3_y = 0

# Delay settings
min_load_time = 23
network_latency_adjust = 0

[xengine]
hosts = roach02081a,roach020712,roach020818,roach02064a
bitstream = /srv/mkat_fpga/bitstreams/xeng_wide/r2_b4a4x256f.fpg

#bitstream = /srv/bofs/r2_b4a4x256f_4gbe_2016_May_23_1536.fpg
#bitstream = /srv/bofs/r2_b4a4x256f_4gbe_2016_May_21_1357.fpg
#bitstream = /srv/bofs/r2_b4a4x256f_4gbe_2016_May_20_0956.fpg
#bitstream = /srv/bofs/r2_b4a4x256f_4gbe_2016_May_19_1657.fpg
#bitstream = /srv/bofs/r2_b4a4x256f_4gbe_2016_May_19_1626.fpg

#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2015_Dec_08_1756.fpg - DOESN'T START
#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2016_Jan_15_1455.fpg - SPIKES
#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2016_Feb_05_1310.fpg - SPIKES
#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2016_Feb_16_1842.fpg - SPIKES
#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2016_Feb_17_1624.fpg - SPIKES
#bitstream = /home/paulp/r2_b4a4x256f_4gbe_2016_Feb_19_1703.fpg - SPIKES

#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Feb_26_1750.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_16_0904.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_21_1345.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_22_1238.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_22_1615.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_23_1441.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_24_1315.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_24_1628.fpg # had new_acc counters, but all was well
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_29_1021.fpg
#bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_30_1049.fpg

# this has a burst bits of 4, as opposed to 3 before
bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_30_1640.fpg

bitstream = /tmp/r2_b4a4x256f_no_b_2016_Mar_31_1002.fpg

# jason's qdr fixes included here
bitstream = /tmp/r2_b4a4x256f_no_b_2016_Apr_01_1646.fpg

# as above but with a stop on error
bitstream = /tmp/r2_b4a4x256f_no_b_2016_Apr_04_1301.fpg

# as above but much deeper snapshot, 2^15 samples
bitstream = /tmp/r2_b4a4x256f_no_b_2016_Apr_06_0916.fpg

# as above but stop the whole vacc on error
bitstream = /tmp/r2_b4a4x256f_no_b_2016_Apr_06_1635.fpg

# this one has no real input, but still uses the rb signal
bitstream = /tmp/r2_b4a4x256f_nob1_2016_Apr_07_1745.fpg

# this one has rb_en tied high
#bitstream = /tmp/r2_b4a4x256f_nob2_2016_Apr_08_0928.fpg

# this one has no input and rb tied high
#bitstream = /tmp/r2_b4a4x256f_nob3_2016_Apr_08_0913.fpg

# copied blocks
bitstream = /tmp/r2_b4a4x256f_nob4_2016_Apr_13_1149.fpg
bitstream = /home/paulp/tmp/vacc_only_001_2016_Apr_15_1527.fpg
#bitstream = /home/paulp/tmp/vacc_only_001_2016_Apr_15_1633.fpg

#bitstream = /home/paulp/tmp/r2_b4a_nob1_2016_Apr_19_1033.fpg
bitstream = /home/paulp/tmp/r2_b4a_nob12_2016_Apr_20_0743.fpg

# errors immediately
#bitstream = /home/paulp/tmp/r2_b4a4x256f_no_b_2016_Apr_21_0956.fpg

# don't error until i enable output
#bitstream = /home/paulp/tmp/r2_b4a_nob12_2016_Apr_21_1214.fpg
#bitstream = /home/paulp/tmp/r2_b4a4x256f_4gbe_2016_Apr_21_1215.fpg

bitstream = /home/paulp/tmp/r2_b4a_nob12_2016_Apr_22_1252.fpg

bitstream = /srv/mkat_fpga/bitstreams/xeng_wide/r2_b4a4x256f.fpg

# x fpga clock speed
#x_fpga_clock = 224000000
x_fpga_clock = 225000000
#x_fpga_clock = 226000000
# Number of X engines per host
x_per_fpga = 4
# Number of spectra to integrate in QDR
accumulation_len = 816
# Number of accumulations performed in the X engine cores
xeng_accumulation_len = 256 
# Number of bits the vacc uses to represent one number
xeng_outbits = 32
# MAC, IP and port for 10Gbe cores
10gbe_start_ip = 10.100.0.110
10gbe_port = 8888
# data product names and destinations
output_products = c856M4k
#output_destination_ip = 239.2.0.100
output_destination_ip = 10.100.201.1
output_destination_port = 8888
# what is the outgoing interface address? i.e. the eth interface that will send the meta information
multicast_interface_address = 127.0.0.1
# Packet length of 10Gbe exchange data in 64 bit words.
10gbe_pkt_len = 512

[dsimengine]
sample_rate_hz = 1712000000
bitstream = /home/paulp/r2_deng_tvg_2015_Jul_07_1702.fpg

# this has the opposite ordered d-engine data
#bitstream = /home/paulp/tmp/r2_deng_tvg_2016_Mar_31_1235.fpg

#bitstream = /srv/mkat_fpga/bitstreams/deng/r2_deng_tvg_rev1_12.fpg
bitstream = /srv/mkat_fpga/bitstreams/deng/r2_deng_tvg_rev1_13.fpg

#bitstream = /home/paulp/bofs/r2_deng_tvg_zero_2016_May_13_2005.fpg

host = roach02082d
10gbe_start_ip = 10.101.0.40
10gbe_port = 8888
pol0_destination_start_ip = 239.2.0.64
pol1_destination_start_ip = 239.2.0.66
